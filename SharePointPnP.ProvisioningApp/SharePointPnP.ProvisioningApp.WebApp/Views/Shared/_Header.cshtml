<script language="javascript">

    document.addEventListener("DOMContentLoaded", function (event) {

        var scope = "site";

        if (window.location.href.indexOf('/tenant/')) {
            scope = "tenant";
        }

        fetch("/" + scope + "/UserProfile/Username")
            .then(data => { return (data.json()); })
            .then(username => {
                if (username) {
                    document.body.querySelector(".pnp-username").textContent = username;
                    document.body.querySelector(".pnp-signinicon").classList.add("signedin");
                }
                else {
                    document.body.querySelector(".pnp-username").textContent = "Sign in";
                    document.body.querySelector(".pnp-signinicon").classList.remove("signedin");
                }
            });
    });

</script>

<header class="pnp-header">
    <div class="pnp-header-inner">
        <div class="pnp-logo">
            <a href="/"><img src="/app/images/pnp-provision-300.png" alt="" class="pnp-logo-img"></a><img src="/app/images/beta-tag.png"
                                                                                                          alt="" class="pnp-logo-beta">
        </div>
        <div class="pnp-title">SharePoint Online Provisioning Service</div>
        <nav class="nav-main">
            <div class="nav-burger">
                <button id="pnp-btn-burger" class="pnp-burger"></button>
            </div>
            <ul class="nav-list">
                <li class="nav-list-item">
                    <a href="https://developer.microsoft.com/en-us/sharepoint/blogs/" class="nav-list-link">SharePoint Developer Blog</a>
                </li>
                <li class="nav-list-item">
                    <a href="http://aka.ms/SharePointPnP" class="nav-list-link">SharePoint PnP</a>
                </li>
                <li class="nav-list-item" style="position: relative;">
                    <div class="pnp-signinicon">
                        <div class="pnp-signin-inner">
                            <a href="/site/home/login" class="pnp-signin-btn">Sign in</a>
                            <div class="pnp-username"></div>
                        </div>
                        <div class="pnp-signin-flyout">
                            <a href="/site/home/logout">Sign out</a>
                        </div>
                    </div>
                </li>
            </ul>
        </nav>
    </div>
</header>
